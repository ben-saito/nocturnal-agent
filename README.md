# Nocturnal Agent / å¤œé–“è‡ªå¾‹é–‹ç™ºã‚·ã‚¹ãƒ†ãƒ 

ğŸŒ™ **Autonomous Night Development System** - Let your code write itself while you sleep!  
ğŸŒ™ **å¤œé–“è‡ªå¾‹é–‹ç™ºã‚·ã‚¹ãƒ†ãƒ ** - ç¡çœ ä¸­ã«ã‚³ãƒ¼ãƒ‰ãŒè‡ªå‹•ã§é–‹ç™ºã•ã‚Œã¾ã™ï¼

Nocturnal Agent is an intelligent system that performs development tasks autonomously during nighttime hours (10 PM - 6 AM), using local LLM orchestration with multi-agent coordination for cost-effective and safe automated coding.

Nocturnal Agentã¯ã€å¤œé–“æ™‚é–“å¸¯ï¼ˆ22:00-06:00ï¼‰ã«é–‹ç™ºã‚¿ã‚¹ã‚¯ã‚’è‡ªå¾‹çš„ã«å®Ÿè¡Œã™ã‚‹ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚ãƒ­ãƒ¼ã‚«ãƒ«LLMã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¨ãƒãƒ«ãƒã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé€£æºã«ã‚ˆã‚Šã€ã‚³ã‚¹ãƒˆåŠ¹ç‡çš„ã§å®‰å…¨ãªè‡ªå‹•ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’å®Ÿç¾ã—ã¾ã™ã€‚

## ğŸ¯ Features / æ©Ÿèƒ½

- **ğŸŒ™ Night Automation / å¤œé–“è‡ªå‹•åŒ–**: Automatic execution during 22:00-06:00 window / 22:00-06:00ã®æ™‚é–“å¸¯ã§ã®è‡ªå‹•å®Ÿè¡Œ
- **ğŸ¤– Multi-Agent Orchestration / ãƒãƒ«ãƒã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆçµ±åˆ**: Coordinates Claude Code, GitHub Copilot, and other coding agents / Claude Codeã€GitHub Copilotç­‰ã®ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’çµ±åˆ
- **ğŸ§  Local LLM Intelligence / ãƒ­ãƒ¼ã‚«ãƒ«LLMçŸ¥èƒ½**: Uses LM Studio for cost-effective task planning and quality assessment / LM Studioã‚’ä½¿ç”¨ã—ãŸã‚³ã‚¹ãƒˆåŠ¹ç‡çš„ãªã‚¿ã‚¹ã‚¯è¨ˆç”»ã¨å“è³ªè©•ä¾¡
- **ğŸ“Š Quality Assurance / å“è³ªä¿è¨¼**: Maintains 0.85+ quality threshold with 3-cycle improvement system / 3ã‚µã‚¤ã‚¯ãƒ«æ”¹å–„ã‚·ã‚¹ãƒ†ãƒ ã§0.85ä»¥ä¸Šã®å“è³ªé–¾å€¤ã‚’ç¶­æŒ
- **ğŸ”’ Safety First / å®‰å…¨æ€§é‡è¦–**: Automatic backups, dangerous command blocking, resource limits / è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã€å±é™ºã‚³ãƒãƒ³ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ã€ãƒªã‚½ãƒ¼ã‚¹åˆ¶é™
- **ğŸ’¡ Learning System / å­¦ç¿’ã‚·ã‚¹ãƒ†ãƒ **: Obsidian-based knowledge accumulation for project-specific patterns / Obsidianãƒ™ãƒ¼ã‚¹ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå›ºæœ‰ãƒ‘ã‚¿ãƒ¼ãƒ³çŸ¥è­˜è“„ç©
- **âš–ï¸ Cost Control / ã‚³ã‚¹ãƒˆç®¡ç†**: $10/month budget with 90%+ free tool preference / æœˆé¡10ãƒ‰ãƒ«äºˆç®—ã§90%ä»¥ä¸Šã®ç„¡æ–™ãƒ„ãƒ¼ãƒ«å„ªå…ˆä½¿ç”¨
- **ğŸ”€ Parallel Execution / ä¸¦åˆ—å®Ÿè¡Œ**: Up to 5 concurrent branches based on quality confidence / å“è³ªä¿¡é ¼åº¦ã«åŸºã¥ãæœ€å¤§5ä¸¦åˆ—ãƒ–ãƒ©ãƒ³ãƒå®Ÿè¡Œ
- **ğŸ“ GitHub Spec Kit Integration / GitHub Spec Kitçµ±åˆ**: Optional spec-driven development when explicitly requested / æ˜ç¤ºçš„ãªè¦æ±‚æ™‚ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ä»•æ§˜é§†å‹•é–‹ç™º

## ğŸš€ Quick Start / ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### Prerequisites / å‰ææ¡ä»¶

- Python 3.9+ / Python 3.9ä»¥ä¸Š
- [LM Studio](https://lmstudio.ai/) with a code model (recommended: CodeLlama 13B) / ã‚³ãƒ¼ãƒ‰ãƒ¢ãƒ‡ãƒ«ä»˜ãLM Studioï¼ˆæ¨å¥¨ï¼šCodeLlama 13Bï¼‰
- [Claude Code CLI](https://docs.anthropic.com/en/docs/claude-code) (authenticated) / Claude Code CLIï¼ˆèªè¨¼æ¸ˆã¿ï¼‰
- Git repository for development / é–‹ç™ºç”¨Gitãƒªãƒã‚¸ãƒˆãƒª

### Installation / ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
# Clone the repository / ãƒªãƒã‚¸ãƒˆãƒªã®ã‚¯ãƒ­ãƒ¼ãƒ³
git clone <repository-url>
cd nocturnal-agent

# Install dependencies / ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pip install -e .

# Initialize configuration / è¨­å®šã®åˆæœŸåŒ–
nocturnal init

# Check system status / ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹ã®ç¢ºèª
nocturnal status
```

### Configuration

Edit `config/nocturnal-agent.yaml` to customize:

```yaml
# Core settings
project_name: "your-project"
working_directory: "/path/to/your/project"

# LLM settings
llm:
  api_url: "http://localhost:1234/v1"
  model_path: "models/codellama-13b"

# Night schedule
scheduler:
  start_time: "22:00"
  end_time: "06:00"
  max_changes_per_night: 10

# Quality thresholds
quality:
  overall_threshold: 0.85
  consistency_threshold: 0.85
```

## ğŸ—ï¸ Architecture

```mermaid
graph TB
    A[Night Scheduler] --> B[Local LLM Agent]
    B --> C[Task Analysis & Quality Check]
    C --> D[Agent Selector]
    D --> E[Claude Code]
    D --> F[GitHub Copilot]
    D --> G[Other Agents]
    E --> H[Consistency Engine]
    F --> H
    G --> H
    H --> I[Quality Assessment]
    I --> J[Obsidian Knowledge Base]
    I --> K[Git Management & Backup]
    I --> L[Improvement Cycle]
    L --> C
```

## ğŸ“‹ Current Implementation Status

- [x] 1. Project foundation and core interfaces
  - [x] Python 3.9+ project structure (src/, tests/, config/)
  - [x] Basic data models (Task, QualityScore, ExecutionResult, ProjectContext)
  - [x] Configuration management system (YAML support)

- [ ] 2. Local LLM Agent implementation
- [ ] 3. CLI coding agent integration system
- [ ] 4. Consistency engine implementation
- [ ] 5. Obsidian integration system
- [ ] 6. Quality improvement cycle implementation
- [ ] 7. Night scheduler implementation
- [ ] 8. Safety and backup system implementation
- [ ] 9. Cost management system implementation
- [ ] 10. Parallel execution features
- [ ] 11. Test suite implementation
- [ ] 12. Configuration and documentation

## ğŸ® Usage / ä½¿ç”¨æ–¹æ³•

### Adding Tasks / ã‚¿ã‚¹ã‚¯ã®è¿½åŠ 

```bash
# Add a simple task / ã‚·ãƒ³ãƒ—ãƒ«ãªã‚¿ã‚¹ã‚¯ã®è¿½åŠ 
nocturnal add-task -t "Fix bug in user authentication" -p high

# Interactive task entry / ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªã‚¿ã‚¹ã‚¯å…¥åŠ›
nocturnal add-task
```

### Night Execution / å¤œé–“å®Ÿè¡Œ

```bash
# Standard execution (no Spec Kit) / æ¨™æº–å®Ÿè¡Œï¼ˆSpec Kitä½¿ç”¨ãªã—ï¼‰
nocturnal start

# Spec Kit driven execution with feature specs / ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ä»•æ§˜ã§ã®Spec Kité§†å‹•å®Ÿè¡Œ
nocturnal start --use-spec-kit --spec-type feature

# Spec Kit driven execution with architecture specs / ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ä»•æ§˜ã§ã®Spec Kité§†å‹•å®Ÿè¡Œ
nocturnal start --use-spec-kit --spec-type architecture

# Test run (dry run) / ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆãƒ‰ãƒ©ã‚¤ãƒ©ãƒ³ï¼‰
nocturnal night-run --dry-run

# Actual night execution (normally runs automatically) / å®Ÿéš›ã®å¤œé–“å®Ÿè¡Œï¼ˆé€šå¸¸ã¯è‡ªå‹•å®Ÿè¡Œï¼‰
nocturnal night-run
```

### GitHub Spec Kit Management / GitHub Spec Kitç®¡ç†

```bash
# Create a new specification / æ–°ã—ã„ä»•æ§˜ã®ä½œæˆ
nocturnal spec create --type feature --title "User Authentication System"

# List all specifications / ã™ã¹ã¦ã®ä»•æ§˜ã®ä¸€è¦§è¡¨ç¤º
nocturnal spec list

# View a specific specification / ç‰¹å®šã®ä»•æ§˜ã®è¡¨ç¤º
nocturnal spec show <spec-file>

# Validate specifications / ä»•æ§˜ã®æ¤œè¨¼
nocturnal spec validate <spec-file>
```

### Monitoring / ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°

```bash
# Check system status / ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹ã®ç¢ºèª
nocturnal status

# Validate configuration / è¨­å®šã®æ¤œè¨¼
nocturnal config-check

# View execution logs / å®Ÿè¡Œãƒ­ã‚°ã®è¡¨ç¤º
tail -f logs/nocturnal-agent.log
```

## ğŸ”§ Development

### Setting up Development Environment

```bash
# Install development dependencies
pip install -e ".[dev]"

# Install pre-commit hooks
pre-commit install

# Run tests
pytest

# Type checking
mypy src/

# Code formatting
black src/ tests/
isort src/ tests/
```

### Project Structure

```
nocturnal-agent/
â”œâ”€â”€ src/nocturnal_agent/           # Main source code
â”‚   â”œâ”€â”€ core/                      # Core models and interfaces
â”‚   â”œâ”€â”€ agents/                    # Agent implementations
â”‚   â”œâ”€â”€ engines/                   # Consistency and quality engines
â”‚   â”œâ”€â”€ managers/                  # System managers
â”‚   â”œâ”€â”€ schedulers/                # Night scheduler
â”‚   â”œâ”€â”€ safety/                    # Safety mechanisms
â”‚   â””â”€â”€ utils/                     # Utilities
â”œâ”€â”€ tests/                         # Test suite
â”‚   â”œâ”€â”€ unit/                      # Unit tests
â”‚   â”œâ”€â”€ integration/               # Integration tests
â”‚   â””â”€â”€ e2e/                       # End-to-end tests
â”œâ”€â”€ config/                        # Configuration files
â”œâ”€â”€ docs/                          # Documentation
â””â”€â”€ knowledge-vault/               # Obsidian knowledge base
```

## âš ï¸ Safety Features / å®‰å…¨æ©Ÿèƒ½

- **Automatic Backups / è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—**: Full repository backup before night execution / å¤œé–“å®Ÿè¡Œå‰ã®å®Œå…¨ãƒªãƒã‚¸ãƒˆãƒªãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
- **Resource Limits / ãƒªã‚½ãƒ¼ã‚¹åˆ¶é™**: CPU 80%, Memory 8GB limits / CPU 80%ã€ãƒ¡ãƒ¢ãƒª8GBåˆ¶é™
- **Dangerous Command Blocking / å±é™ºã‚³ãƒãƒ³ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯**: Prevents destructive operations / ç ´å£Šçš„æ“ä½œã®é˜²æ­¢
- **File Change Limits / ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´åˆ¶é™**: Maximum 20 file changes per task / ã‚¿ã‚¹ã‚¯ã‚ãŸã‚Šæœ€å¤§20ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´
- **Git Branch Isolation / Gitãƒ–ãƒ©ãƒ³ãƒåˆ†é›¢**: All work done in dedicated branches / å°‚ç”¨ãƒ–ãƒ©ãƒ³ãƒã§ã®å…¨ä½œæ¥­å®Ÿè¡Œ
- **Quality Gates / å“è³ªã‚²ãƒ¼ãƒˆ**: 0.85+ quality threshold for automatic application / è‡ªå‹•é©ç”¨ã®ãŸã‚ã®0.85ä»¥ä¸Šã®å“è³ªé–¾å€¤

## ğŸ¤ Contributing / è²¢çŒ®

1. Fork the repository / ãƒªãƒã‚¸ãƒˆãƒªã‚’ãƒ•ã‚©ãƒ¼ã‚¯
2. Create a feature branch / ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ãƒ–ãƒ©ãƒ³ãƒã‚’ä½œæˆ (`git checkout -b feature/amazing-feature`)
3. Commit your changes / å¤‰æ›´ã‚’ã‚³ãƒŸãƒƒãƒˆ (`git commit -m 'Add amazing feature'`)
4. Push to the branch / ãƒ–ãƒ©ãƒ³ãƒã«ãƒ—ãƒƒã‚·ãƒ¥ (`git push origin feature/amazing-feature`)
5. Open a Pull Request / ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é–‹ã

## ğŸ“œ License / ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.  
ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯MITãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ä¸‹ã§ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã•ã‚Œã¦ã„ã¾ã™ - è©³ç´°ã¯[LICENSE](LICENSE)ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã”è¦§ãã ã•ã„ã€‚

## ğŸ™ Acknowledgments / è¬è¾

- [LM Studio](https://lmstudio.ai/) for local LLM infrastructure / ãƒ­ãƒ¼ã‚«ãƒ«LLMã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ã®æä¾›
- [Claude Code](https://docs.anthropic.com/en/docs/claude-code) for intelligent coding assistance / ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ãƒˆã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°æ”¯æ´
- [Obsidian](https://obsidian.md/) for knowledge management inspiration / ãƒŠãƒ¬ãƒƒã‚¸ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆã®ã‚¤ãƒ³ã‚¹ãƒ”ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
- [GitHub Spec Kit](https://github.com/github/spec-kit) for structured technical specifications / æ§‹é€ åŒ–æŠ€è¡“ä»•æ§˜ã®æä¾›